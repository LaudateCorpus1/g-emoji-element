#!/usr/bin/env node

// Generates the modifiers.js module with a list of emoji that support
// skin tone modifiers.
//
// When new emoji are published in updated Unicode versions:
//
// 1. Add the emoji to muan/unicode-emoji-json and publish a release
// 2. npm update unicode-emoji-json
// 3. npm run generate-emoji
// 4. git commit -am "Update emoji list"

const data = require('unicode-emoji-json/data-by-group.json')

const pluck = key => obj => obj[key]
const isFitzpatrick = pluck('fitzpatrick_scale')
const emoji = pluck('emoji')
const quote = text => `'${text}'`
const quoted = Object.values(data)
  .flat()
  .filter(isFitzpatrick)
  .map(emoji)
  .map(quote)

const script = `
// Generated by script/generate-emoji-modifiers.
// You MUST commit any modifications to this file.

/* @flow strict */

const supported = new Set([${quoted.join(',')}])

export function isModifiable(emoji: string): boolean {
  return supported.has(emoji)
}
`

console.log(script)
